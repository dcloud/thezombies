{% extends "base.html" %}{% load staticfiles %}{% load compress %}{% load tz %}{% load brains %}
{% block content %}
    {% include "_audit_header.html" %}
    <section>
        <h3>Summary</h3>
        <h4 class="subheader">Ran {{ object.probe_set.count }} probes for audit.</h4>
        {% for probe in object.probe_set.all %}
        <section>
            <h5>{{ probe.get_probe_type_display }}: {{ probe.errors|length }} errors</h5>
            <ul>
            {% for error in probe.errors %}
                <li>{{ error|truncatewords:80 }}</li>
            {% endfor %}
            </ul>
        </section>
        {% endfor %}
        <h4 class="subheader">{{ object.inspections_count|default:0 }} URLs were inspected.</h4>
        {% if object.inspections %}
        <table>
            <caption>Here are the last few URLs inspected:</caption>
            <thead>
                <tr>
                    <th>Requested url</th>
                    <th>Status Code</th>
                    <th>Encoding</th>
                </tr>
            </thead>
            <tbody>
            {% for inspection in object.inspections|slice:":10" %}
                <tr>
                    <td>{{ inspection.requested_url|urlizetrunc:60 }}</td>
                    <td>{{ inspection.status_code }}</td>
                    <td>{{ inspection.encoding|default:"Not specified" }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
        <p><a href="{% url 'audit-url-list' pk=object.pk %}">View all results</a></p>
        {% endif %}
    </section>
{% endblock %}